<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Chat com Copilot (Backend Genérico)</title>
  <style>
    body { font-family: Arial, sans-serif; background: #222; color: #f2f2f2; }
    #chatbox { width: 90%; max-width: 600px; margin: 40px auto; padding: 20px; background: #333; border-radius: 8px; }
    .msg { margin: 15px 0; }
    .user { text-align: right; color: #8fe1a2; }
    .bot { text-align: left; color: #7dbbff; }
    #inputRow { display: flex; margin-top: 20px; }
    #userInput { flex: 1; padding: 10px; border-radius: 5px; border: none; }
    #sendBtn { padding: 10px 16px; background: #5b9aff; color: #fff; border: none; border-radius: 5px; cursor: pointer; margin-left: 10px; }
  </style>
</head>
<body>
  <div id="chatbox">
    <h2>Copilot Chat (Backend Genérico)</h2>
    <div id="messages"></div>
    <div id="inputRow">
      <input type="text" id="userInput" placeholder="Digite sua pergunta..." autocomplete="off" />
      <button id="sendBtn">Enviar</button>
    </div>
  </div>
  <script>
    const BACKEND_URL = "http://localhost:5000/pergunte"; // Altere conforme o endpoint do seu Copilot

    const messagesDiv = document.getElementById('messages');
    const userInput = document.getElementById('userInput');
    const sendBtn = document.getElementById('sendBtn');

    function addMessage(text, sender) {
      const msgDiv = document.createElement('div');
      msgDiv.className = 'msg ' + sender;
      msgDiv.innerHTML = text;
      messagesDiv.appendChild(msgDiv);
      messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }

    async function askCopilot(question) {
      addMessage(question, 'user');
      addMessage('Pensando...', 'bot');
      try {
        const res = await fetch(BACKEND_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ pergunta: question }) // Altere o formato conforme seu backend
        });
        const data = await res.json();
        document.querySelectorAll('.bot').forEach(el => {
          if (el.innerText === 'Pensando...') el.remove();
        });
        addMessage(data.resposta || JSON.stringify(data), 'bot');
      } catch (e) {
        document.querySelectorAll('.bot').forEach(el => {
          if (el.innerText === 'Pensando...') el.remove();
        });
        addMessage('Erro ao conectar ao backend Copilot.', 'bot');
      }
    }

    sendBtn.onclick = () => {
      const q = userInput.value.trim();
      if (q) {
        askCopilot(q);
        userInput.value = '';
      }
    };

    userInput.addEventListener('keydown', function(e) {
      if (e.key === 'Enter') sendBtn.onclick();
    });
  </script>
</body>
</html>
